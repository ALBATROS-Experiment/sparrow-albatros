<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Collecting data (quick start) - Sparrow Albatros</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../stylesheets/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Collecting data (quick start)";
        var mkdocs_page_input_path = "collecting-data-quickstart.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/c.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Sparrow Albatros
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Embedded Software</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Collecting data (quick start)</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../collecting-data-in-depth/">Collecting data (in depth)</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gateware</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../installing-the-toolchain/">Installing the Toolchain</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gateware-design/">Gateware Design Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gateware-documentation/">Gateware</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Disk Images</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../installing-sparrow-albatros/">Installing Sparrow Albatros</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Sparrow Albatros</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Embedded Software</li>
      <li class="breadcrumb-item active">Collecting data (quick start)</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <p>We start from the assumption that you have correctly setup the Sparrow-Albatros readout system.</p>
<h2 id="boot-and-tunnel-into-the-sparrow">Boot and tunnel into the Sparrow</h2>
<ol>
<li>Power the RF-shielded box with a 24V power supply through the barrel port labelled IN. The Zynq's ARM core will boot off of the SD card mounted in the Sparrow's SD card slot. </li>
<li>Connect your laptop to the Sparrow using an ethernet cable. </li>
<li>If you have trouble with the next two steps you may need to configure the ethernet interface manually to be on the 10.10.xx.xx subnet (subnet mask 255.255.0.0, with an IP address e.g. 10.10.11.55)</li>
<li>Check that you can connect to the Sparrow with <code>ping 10.10.11.99</code>. The Sparrow's IP address on this LAN is set statically and should not change. Then ssh into the Sparrow with <code>ssh casper@10.10.11.99</code>. When prompted</li>
</ol>
<h2 id="collecting-data">Collecting data</h2>
<p>Now that you've tunneled in, you can run data collection. </p>
<ol>
<li>Find out the name of the drive connected with <code>lsblk</code>, it will probably be <code>sda1</code></li>
<li>Mount the drive <code>sudo mount /dev/sda1 /media/BASEBAND</code></li>
<li>Navigate to the software directory <code>cd ~/sparrow-albatros/software</code></li>
<li>Modify the user configuration file <code>config.ini</code> to fit your needs</li>
<li>Configure the FPGA with <code>python configfpga.py</code> and make sure the switch's lights are flashing consistently. </li>
<li>Start a screen session for recording the on board correlations <code>screen -S spec</code></li>
<li>From this screen session run <code>python dump_spectra.py</code></li>
<li>Detach yourself from the screen session with <code>ctrl</code>+<code>a</code>+<code>d</code> </li>
<li>Start a new screen session for running the baseband collection script <code>screen -S baseband</code></li>
<li>If you are collecting 4-bit data run <code>python set_optimal_coeffs.py</code>, this uses the on board correlation to optimally set the digital gain coefficients at the requantization stage. [!NOTE] This can only be run at least 15 seconds after the FPGA has been configured (step 5)</li>
<li>Compile the c-code that reads UDP packets and writes them to disk with <code>make clean;make</code></li>
<li>Run the c-code with superuser privilages <code>sudo ./dump_baseband</code></li>
<li>Detach yourself from the screen session <code>ctrl</code>+<code>a</code>+<code>d</code></li>
<li>Check that on-board correlations are being written to <code>~/data_auto_cross</code> and that baseband is being written to <code>/media/BASEBAND/baseband</code>. An easy way to do this is to <code>ls -lh</code> multiple times and watch files grow.</li>
</ol>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href=".." class="btn btn-neutral float-left" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../collecting-data-in-depth/" class="btn btn-neutral float-right" title="Collecting data (in depth)">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href=".." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../collecting-data-in-depth/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
