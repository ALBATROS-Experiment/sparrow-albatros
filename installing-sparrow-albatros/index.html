<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Installing Sparrow Albatros - Sparrow Albatros</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="../stylesheets/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Installing Sparrow Albatros";
        var mkdocs_page_input_path = "installing-sparrow-albatros.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/c.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Sparrow Albatros
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Embedded Software</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../embedded/data-collection/">Run the DAQ, collect data</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../embedded/tuning-the-gateware/">Tuning the gateware</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../embedded/digital-gain-coefficients-4bit/">Optimal Digital Gain Coefficients (4-bit)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../embedded/dump-baseband/">Dumping baseband</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../embedded/dump-spectra/">Dumping correlated spectra</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../embedded/networking/">Networking</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Gateware</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../gateware/installing-the-toolflow/">Installing the Toolflow</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gateware/gateware-design/">Design Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gateware/fft-note/">Note on FFT Implementation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gateware/gateware-modify-simulate/">Modify and Simulate</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gateware/gateware-compile-synthesize-implement/">Compile, Synthesize, Implement</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Disk Images</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Installing Sparrow Albatros</a>
    <ul class="current">
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Data Specification</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../data-baseband/">Baseband</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../data-correlated-spectra/">Correlated Spectra</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Thesis</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../thesis/ch1-thesis-overview/">Thesis Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../thesis/ch2-science-intro/">Science Intro</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../thesis/ch3-albatros-experiment/">ALBATROS Experiment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../thesis/ch4-snap-readout/">SNAP Readout System</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../thesis/ch5-sparrow-readout/">Sparrow Readout System</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../thesis/ch6-field-results/">Field Results</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Sparrow Albatros</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Disk Images</li>
      <li class="breadcrumb-item active">Installing Sparrow Albatros</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <p>We're running Ubuntu 18.04.6 LTS (Bionic Beaver) on the Sparrow's ARM processor. </p>
<h2 id="quick-start">Quick start</h2>
<p>You have all the hardware for a Sparrow-Albatros data acquisition system and you want to get the software up and running for data collection. Easy, just download the latest image from <a href="https://github.com/ALBATROS-Experiment/sparrow-albatros/tree/main/os-sd-images">os-sd-images directory</a>, unzip it, and write it onto a fresh SD card. </p>
<p><img alt="âš " class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /> To save time writing the image we shrink the main filesystem partition. If the image hasn't automatically resized, make sure to resize the partition so that it takes up the full disk space. To do this:</p>
<ul>
<li>Insert the SD card into a linux machine or computer, if using an SD card sleeve, make sure it is in writable mode (physical slot switched upwards, towards metal)</li>
<li>If it auto-mounts, <em>unmount it</em></li>
<li>Open gparted <em>as superuser</em> <code>sudo gparted</code></li>
<li>Select the volume corresponding to the SD card</li>
<li>Resize the filesystem partition "rootfs" so that it fills the remaining disk space (right-click, resize, drag and drop, click green tick box <em>apply all operations</em>) </li>
</ul>
<p>Stick the card into the Sparrow board's microSD card slot and you're good to go! </p>
<h2 id="installing-sparrow-albatros-software-onto-a-fresh-sd-card">Installing Sparrow-Albatros software onto a fresh SD card</h2>
<p>If you want to install and this software on a different OS, here are a few things to look out for:</p>
<ul>
<li>When cloning the repository, make sure to not pull large files. If git-lfs is installed cloning will by default pull large files from the repository. To avoid pulling large files execute <code>export GIT_LFS_SKIP_SMUDGE=1</code> then <code>git clone --filter=blob:none https://github.com/ALBATROS-Experiment/sparrow-albatros</code></li>
<li>You need to install <a href="https://www.realtimeradio.co.uk/hardware">realtimeradio</a>'s <a href="https://github.com/realtimeradio/sparrow-fpga">sparrow-fpga</a> repository and configure the <code>zync_scripts/onboot.sh</code> script to run on boot. In our imaged setup the onboot script is symlinked to the user's root directory and executes automatically on each boot. The <code>onboot.sh</code> script sets some environment variables and configures the PLL. </li>
<li>For the LEO Bodnar GPS module to work, copy <code>software/10-local.rules</code> to <code>/etc/udev/rules.d/</code>. Then reboot or reload the udevadm with <code>sudo udevadm control --reload</code>, <code>sudo udevadm trigger</code>. Check that it's working by running the <code>software/check_lb.py</code> script <em>as superuser</em>.</li>
<li>For to set up a reverse tunnel on boot you need to make a service. You can follow the example of the service at <code>/etc/systemd/system/reverse-tunnel-service-tb-stephenfay.service</code> which sets up a reverse tunnel to my twiddlebug user on boot. </li>
</ul>
<p>Reverse tunnel service <code>reverse-tunnel-service-tb-stephenfay.service</code></p>
<pre><code>[Unit]
Description=Reverse SSH tunnel
After=network-online.target
Wants=network-online.target

[Service]
ExecStart=/usr/bin/ssh -N -R 18997:localhost:22 -p 2690 -i /home/casper/.ssh/id_rsa_sparrow_tb -o StrictHostKeyChecking=no -o ServerAliveInterval=60 -o ExitOnForwardFailure=yes stephenfay@132.206.126.20
RestartSec=30
Restart=always
User=casper

[Install]
WantedBy=multi-user.target
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../gateware/gateware-compile-synthesize-implement/" class="btn btn-neutral float-left" title="Compile, Synthesize, Implement"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../data-baseband/" class="btn btn-neutral float-right" title="Baseband">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../gateware/gateware-compile-synthesize-implement/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../data-baseband/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../wavedrom-init.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
